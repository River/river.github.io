<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>River Jiang</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; }
        canvas { display: block; }
        #content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center; }
        ul { list-style-type: none; }
    </style>
</head>
<body>
    <div id="content">
        <h2>Cardiology Fellow at UBC</h2>
        <p>
            River Jiang is a dedicated cardiology fellow at the University of British Columbia, with an interest in the application of machine learning in cardiology and clinical echocardiography. 
        </p>
        <h3>Publications:</h3>
        <ul id="publications">
            <!-- Publications will be populated here -->
        </ul>
        <p>
            <a href="https://github.com/river" target="_blank">GitHub</a> | 
            <a href="https://twitter.com/riverjiang" target="_blank">Twitter</a>
        </p>
    </div>

    <script>
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const loader = new THREE.FontLoader();
        loader.load('https://raw.githubusercontent.com/mrdoob/three.js/master/examples/fonts/helvetiker_bold.typeface.json', function (font) {
            const geometry = new THREE.TextGeometry('River Jiang', {
                font: font,
                size: 3,
                height: 0.5
            });

            const material = new THREE.MeshNormalMaterial();
            const textMesh = new THREE.Mesh(geometry, material);
            scene.add(textMesh);
        });

        camera.position.z = 10;
        const animate = function () {
            requestAnimationFrame(animate);
            renderer.render(scene, camera);
        };
        animate();

        // Fetching publications from PubMed
        const fetchPublications = async () => {
            const query = "River Jiang[Author]";
            const url = `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&term=${query}&retmode=json`;
            const response = await fetch(url);
            const data = await response.json();
            const ids = data.esearchresult.idlist.join(",");

            const summaryUrl = `https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=${ids}&retmode=json`;
            const summaryResponse = await fetch(summaryUrl);
            const summaryData = await summaryResponse.json();
            const publicationsList = document.getElementById("publications");
            for (const id in summaryData.result) {
                if (id !== "uids") {
                    const title = summaryData.result[id].title;
                    const authors = summaryData.result[id].authors.map(author => author.name).join(", ");
                    const journal = summaryData.result[id].source;
                    const year = summaryData.result[id].pubdate.substring(0, 4);

                    const listItem = document.createElement("li");
                    listItem.innerHTML = `${authors}. (${year}). ${title}. <i>${journal}</i>.`;

                    publicationsList.appendChild(listItem);
                }
            }
        };
        fetchPublications();

        // Adjust canvas size on window resize
        window.addEventListener("resize", () => {
            const width = window.innerWidth;
            const height = window.innerHeight;
            renderer.setSize(width, height);
            camera.aspect = width / height;
            camera.updateProjectionMatrix();
        });
    </script>
</body>
</html>
